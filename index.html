<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Su Squares, cute squares you own and personalize</title>
  <meta name="description" content="The first ERC-721 NFT. Cute squares you own and personalize.">
  <link rel="canonical" href="https://tenthousandsu.com" />
  <link rel="stylesheet" href="assets/main.css?20210926">
</head>

<body>
  <header>
    <a id="logo" href="/"><img src="assets/logo-su-squares.svg" style="width:348px;height:57px;object-fit: cover;">
      </div></a>
    <span>
      The first ERC-721 NFT<br>
      <strong>Available: <span id="available-plug">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong>
    </span>
    <a class="btn" href="white-paper">About us</a>
    <a class="btn" href="buy">Buy</a>
    <a class="btn" href="https://tools.tenthousandsu.com/personalize-underlay">Personalize</a>
    <a class="btn" target="twitter" href="https://twitter.com/susquares">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter"
        viewBox="0 0 16 16">
        <path
          d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" />
      </svg>
    </a>
    <a class="btn" target="twitter" href="https://discord.gg/6nTGNdjQ3B">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-discord"
        viewBox="0 0 16 16">
        <path
          d="M13.545 2.907a13.227 13.227 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.19 12.19 0 0 0-3.658 0 8.258 8.258 0 0 0-.412-.833.051.051 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019c.308-.42.582-.863.818-1.329a.05.05 0 0 0-.01-.059.051.051 0 0 0-.018-.011 8.875 8.875 0 0 1-1.248-.595.05.05 0 0 1-.02-.066.051.051 0 0 1 .015-.019c.084-.063.168-.129.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.052.052 0 0 1 .053.007c.08.066.164.132.248.195a.051.051 0 0 1-.004.085 8.254 8.254 0 0 1-1.249.594.05.05 0 0 0-.03.03.052.052 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.235 13.235 0 0 0 4.001-2.02.049.049 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034 0 0 0-.02-.019Zm-8.198 7.307c-.789 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612Zm5.316 0c-.788 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612Z" />
      </svg>
    </a>
  </header>

  <article>
    <p style="display:flex; justify-content: space-between">
      <span>Click below to purchase an available Su Square for 0.5 Ether.</span>
      <span>Or <a style="color:#ffd700"
          href="mailto:Su@TenThousandSu.com?subject=Buy%20a%20random%20Square&body=Hi%20Su!%0A%0AI'd%20like%20to%20buy%20%20a%20random%20Su%20Squares%20at%20a%20cheaper%20price.%0A%0AMy%20wallet%20address%20is%20XXXXXXXXXXX%0A%0A">buy
          a
          <img
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADZQTFRF9sxg2ZYl1ZI67sAy3aNk9sAMYE8ZFBAA2ZY6yIE++sQIwHk62ZI69sQI8sAI9sQM1ZpkbGRb8/GKXwAAAGVJREFUeJyFkFkOgDAIBevCK3X3/pe1tFatYJwfwgRCeM41b9rO9aRAlPCV8d9S4CDwtT4kB+G0t5Qu5PIvuZYEpFtjJSNTOqbl/VGRbEmCOfkIZLbWlxJIrjmQ1UhpIwXcDoU/ANslCMY1JLSSAAAAAElFTkSuQmCC"
            style="height:20px; width:20px; image-rendering: pixelated;">
          random Square</a> at a lower price.</span>
    </p>
    <a id="wheretogo" href="" target="_blank">
      <div style="position:relative;height:1000px">
        <img id="image" src="build/wholeSquare.png" alt="All Su Squares" style="margin:0; height:1000px; width:1000px">
        <div id="position"
          style="background:pink;opacity:0.8; width:10px;height:10px;top:0;left:0;position:absolute;pointer-events:none;display:none">
        </div>
        <div id="tooltip" style="color:black"></div>
        <div id="electric-fence"></div>
      </div>
    </a>
  </article>

  <article>
    <section id="newly-minted" style="display:flex; align-items: center; width: 100%; margin-bottom: 2em">
      <strong style="flex: 1 1 0">Newly minted</strong>
    </section>
    <section id="newly-personalized" style="display:flex; align-items: center; width: 100%">
      <strong style="flex: 1 1 0">Latest personalized</strong>
    </section>
  </article>

  <footer>
    <small>
      No cookies. No analytics. Not responsible for content of linked sites. Images shown on homepage are &copy; their
      respective owners. This image refreshes <a target="_blank" href="https://github.com/su-squares/tenthousandsu.com/actions/workflows/load-from-blockchain.yml">approx. hourly</a>. To the extent possible under law, Su Entriken has waived
      all copyright and related or neighboring rights to the TenThousandSu.com website. This work is published from the
      United States.
    </small>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script>
    var allData = []; // Each is [version, title, href, blockNumber] or null
    $.get("build/squarePersonalizations.json", function (data) {
      allData = [""].concat(data); // JSON zero-indexed, allData is one-indexed
      const reducer = (accumulator, currentValue) => accumulator + !!currentValue;
      const sold = allData.slice(1).reduce(reducer, 0);
      $("#available-plug").text((10000 - sold).toLocaleString());
      stepFence();

      let mintedSquares = [];
      let personalizedSquares = [];
      $.get("build/squareExtra.json", function (data) {
        allExtraData = [""].concat(data); // Data is zero-indexed
        for (let squareNumber = 1; squareNumber <= 10000; squareNumber++) {
          const square = allData[squareNumber];
          if (square === null) {
            // Square is not yet minted
            continue;
          }
          const squareExtra = allExtraData[squareNumber];
          mintedSquares.push([squareNumber, square, squareExtra]);
          if (square[0] === 0 && square[1] === "" && square[2] === "") {
            // Square is minted but not personalized
            continue;
          }
          personalizedSquares.push([squareNumber, square, squareExtra]);
        }

        // 5 most recent minted Squares
        const mostRecentMintedSquares = mintedSquares.sort((a, b) => b[2][0] - a[2][0]).slice(0, 5);
        mostRecentMintedSquares.forEach(square => {
          [squareNumber, squareData, extraData] = square;
          [version, title, href, blockNumber] = squareData;
          [mintedBlock, updatedBlock, underlayVisible] = extraData;

          const row = Math.floor((squareNumber - 1) / 100);
          const col = (squareNumber - 1) % 100;

          $("#newly-minted")
            .append(
              // Flex orient vertical
              $("<a style='display:flex; flex-direction: column; align-items: center; justify-content: center; flex: 1 1 0'>")
                .attr("href", "https://tenthousandsu.com/square#" + squareNumber)
                .append($("<div>")
                  .css({
                    background: 'url("https://tenthousandsu.com/build/wholeSquare.png")',
                    height: '10px',
                    width: '10px',
                    "background-position-x": -col * 10,
                    "background-position-y": -row * 10,
                    display: "inline-block",
                    "zoom": "5",
                    "image-rendering": "pixelated",
                  })
                )
                .append($('<p>')
                  .text("#" + squareNumber)
                )
            );
        });

        // 5 most recent personalized Squares
        const mostRecentPersonalizedSquares = personalizedSquares.sort((a, b) => b[1][3] - a[1][3]).slice(0, 5);
        mostRecentPersonalizedSquares.forEach(square => {
          [squareNumber, squareData, extraData] = square;
          [version, title, href, blockNumber] = squareData;
          [mintedBlock, updatedBlock, underlayVisible] = extraData;

          const row = Math.floor((squareNumber - 1) / 100);
          const col = (squareNumber - 1) % 100;

          $("#newly-personalized")
            .append(
              // Flex orient vertical
              $("<a style='display:flex; flex-direction: column; align-items: center; justify-content: center; flex: 1 1 0'>")
                .attr("href", "https://tenthousandsu.com/square#" + squareNumber)
                .append($("<div>")
                  .css({
                    background: 'url("https://tenthousandsu.com/build/wholeSquare.png")',
                    height: '10px',
                    width: '10px',
                    "background-position-x": -col * 10,
                    "background-position-y": -row * 10,
                    display: "inline-block",
                    "zoom": "5",
                    "image-rendering": "pixelated",
                  })
                )
                .append($('<p>')
                  .text("#" + squareNumber)
                )
            );
        });
      });
    });

    function getSquareNumber(e, element) {
      var x = Math.floor((e.pageX - $(element).offset().left) / 10);
      x = x <= 0 ? 0 : x >= 99 ? 99 : x;
      var y = Math.floor((e.pageY - $(element).offset().top) / 10);
      y = y <= 0 ? 0 : y >= 99 ? 99 : y;
      //console.log([x,y]);
      return x + y * 100 + 1;
    }
    $("#image").on("mouseover mousemove", function (e) {
      const squareNumber = getSquareNumber(e, this);
      const left = 10 * ((squareNumber - 1) % 100);
      const top = 10 * Math.floor((squareNumber - 1) / 100);
      let title = "Square #" + (squareNumber) + "\n";
      //console.log("Entering square "+squareNumber);
      if (allData[squareNumber] == null) {
        $("#image").css("cursor", "pointer");
        title = title + " is available for sale, click to buy.";
        if (theFence.has(squareNumber)) {
          title = title + " On the electric fence. Only available for sale with Ether.";
        }
        $("#position").css({ left: left, top: top, display: "block" });
        $("#wheretogo").attr("href", "buy?square=" + (squareNumber));
      } else if (!allData[squareNumber][1] && !allData[squareNumber][2]) {
        $("#image").css("cursor", "not-allowed");
        title = title + " WAS PURCHASED BUT NOT YET PERSONALIZED";
        $("#position").css({ left: left, top: top, display: "block" });
        $("#wheretogo").removeAttr("href");
      } else {
        $("#image").css("cursor", "pointer");
        title = title + allData[squareNumber][1];
        $("#position").css({ left: left, top: top, display: "block" });
        $("#wheretogo").attr("href", allData[squareNumber][2]);
      }

      $("#tooltip").text(title);
      $("#tooltip").css({ left: left, top: top + 30, display: "block" });
    });
    $("#image").mouseout(function () {
      $("#position, #tooltip").css({ display: "none" });
    });

    const litUpEdge = new Set([1]);
    const wasEverLitUp = new Set([1]);
    const theFence = new Set();

    function stepFence() {
      if (litUpEdge.size == 0) {
        return;
      }
      const nextLitUpEdge = new Set();
      litUpEdge.forEach(function (square) {
        if (square > 100) {
          nextLitUpEdge.add(square - 100);
        }
        if (square <= 100 * 99) {
          nextLitUpEdge.add(square + 100);
        }
        if (square % 100 != 1) {
          nextLitUpEdge.add(square - 1);
        }
        if (square % 100 != 0) {
          nextLitUpEdge.add(square + 1);
        }
        $('#electric-fence-' + square).remove();
      });
      litUpEdge.clear();
      nextLitUpEdge.forEach((square) => {
        if (wasEverLitUp.has(square)) {
          return;
        }
        wasEverLitUp.add(square);
        if (allData[square] == null) {
          theFence.add(square);
        } else {
          litUpEdge.add(square);
        }
        $('#electric-fence').append('<div id="electric-fence-' + square + '" style="pointer-events:none;position:absolute;left:' + ((square - 1) % 100 * 10) + 'px;top:' + Math.floor((square - 1) / 100) * 10 + 'px;width:10px;height:10px;background:#ffd700;opacity:0.25"></div>');
      });
      setTimeout(() => { stepFence() }, 25);
      console.log("litUpEdge: ", litUpEdge);
      console.log("wasEverLitUp: ", wasEverLitUp);
      console.log("theFence: ", theFence);
    }
  </script>
</body>

</html>